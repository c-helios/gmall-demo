{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport { reqCode, reqUserRegister, reqUserLogin, reqUserInfo, reqLoginOut } from '@/api';\nimport { setToken, getToken, removeToken } from '@/utils/token.js';\nconst state = {\n  code: '',\n  token: getToken(),\n  userInfo: {}\n};\nconst mutations = {\n  GETCODE(state, code) {\n    state.code = code;\n  },\n\n  USERLOGIN(state, token) {\n    state.token = token;\n  },\n\n  GETUSERINFO(state, userInfo) {\n    state.userInfo = userInfo;\n  },\n\n  LOGINOUT(state) {\n    state.token = '';\n    state.userInfo = {};\n    removeToken();\n  }\n\n};\nconst actions = {\n  // 获取验证码\n  async getCode({\n    commit\n  }, phone) {\n    let result = await reqCode(phone);\n\n    if (result.code == 200) {\n      commit('GETCODE', result.data);\n    } else {\n      alert(error);\n    }\n  },\n\n  // 注册用户\n  async userRegister({\n    commit\n  }, userData) {\n    let result = await reqUserRegister(userData);\n\n    if (result.code == 200) {\n      return true;\n    } else {\n      return Promise.reject(new Error('faile'));\n    }\n  },\n\n  // 用户登录\n  async userLogin({\n    commit\n  }, userData) {\n    let result = await reqUserLogin(userData);\n\n    if (result.code == 200) {\n      commit('USERLOGIN', result.data.token); // 持久化存储token\n\n      setToken(result.data.token);\n      return 'ok';\n    } else {\n      return Promise.reject(new Error('faile'));\n    }\n  },\n\n  // 获取用户信息\n  async getUserInfo({\n    commit\n  }) {\n    let result = await reqUserInfo();\n\n    if (result.code == 200) {\n      commit('GETUSERINFO', result.data);\n      return 'ok';\n    } else {\n      return Promise.reject(new Error('getUserInfoFaile'));\n    }\n  },\n\n  // 退出登录\n  async loginOut({\n    commit\n  }) {\n    let result = await reqLoginOut();\n\n    if (result.code == 200) {\n      commit('LOGINOUT');\n      return 'ok';\n    } else {\n      return Promise.reject(new Error('reqLoginOutFaile'));\n    }\n  }\n\n};\nconst getters = {};\nexport default {\n  state,\n  mutations,\n  actions,\n  getters\n};","map":{"version":3,"names":["reqCode","reqUserRegister","reqUserLogin","reqUserInfo","reqLoginOut","setToken","getToken","removeToken","state","code","token","userInfo","mutations","GETCODE","USERLOGIN","GETUSERINFO","LOGINOUT","actions","getCode","commit","phone","result","data","alert","error","userRegister","userData","Promise","reject","Error","userLogin","getUserInfo","loginOut","getters"],"sources":["/Users/hcw/vueProjects/gmall/src/store/user/index.js"],"sourcesContent":["import { reqCode, reqUserRegister, reqUserLogin, reqUserInfo, reqLoginOut } from '@/api'\nimport { setToken, getToken, removeToken } from '@/utils/token.js'\nconst state = {\n  code: '',\n  token: getToken(),\n  userInfo: {}\n}\nconst mutations = {\n  GETCODE (state, code) {\n    state.code = code\n  },\n  USERLOGIN (state, token) {\n    state.token = token\n  },\n  GETUSERINFO (state, userInfo) {\n    state.userInfo = userInfo\n  },\n  LOGINOUT (state) {\n    state.token = ''\n    state.userInfo = {}\n    removeToken()\n  }\n}\nconst actions = {\n  // 获取验证码\n  async getCode ({ commit }, phone) {\n    let result = await reqCode(phone)\n    if (result.code == 200) {\n      commit('GETCODE', result.data)\n    } else {\n      alert(error)\n    }\n  },\n  // 注册用户\n  async userRegister ({ commit }, userData) {\n    let result = await reqUserRegister(userData)\n    if (result.code == 200) {\n      return true\n    } else {\n      return Promise.reject(new Error('faile'))\n    }\n  },\n  // 用户登录\n  async userLogin ({ commit }, userData) {\n    let result = await reqUserLogin(userData)\n    if (result.code == 200) {\n      commit('USERLOGIN', result.data.token)\n      // 持久化存储token\n      setToken(result.data.token)\n      return 'ok'\n    } else {\n      return Promise.reject(new Error('faile'))\n    }\n  },\n  // 获取用户信息\n  async getUserInfo ({ commit }) {\n    let result = await reqUserInfo()\n    if (result.code == 200) {\n      commit('GETUSERINFO', result.data)\n      return 'ok'\n    } else {\n      return Promise.reject(new Error('getUserInfoFaile'))\n    }\n  },\n  // 退出登录\n  async loginOut ({ commit }) {\n    let result = await reqLoginOut()\n    if (result.code == 200) {\n      commit('LOGINOUT')\n      return 'ok'\n    } else {\n      return Promise.reject(new Error('reqLoginOutFaile'))\n    }\n  }\n\n}\nconst getters = {}\nexport default {\n  state,\n  mutations,\n  actions,\n  getters\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}